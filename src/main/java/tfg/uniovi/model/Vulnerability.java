package tfg.uniovi.model;

import java.util.Date;

import javax.persistence.Entity;
import javax.persistence.Id;

import tfg.uniovi.model.dto.VulnerabilityDTO;
import tfg.uniovi.model.dto.concreteClasses.Access;
import tfg.uniovi.model.dto.concreteClasses.Impact;

@Entity
public class Vulnerability {
	@Id
	private String id;
	private Date published;
	private Access access;
	private double cvss;
	private Date cvss_time;
	private String cwe;
	private Impact impact;
	private String[] references;
	private String summary;
	private String[] vulnerable_configuration;
	private String solution;
	
	public Vulnerability() {
	}
	
	public Vulnerability(VulnerabilityDTO vuln) {
		super();
		this.id = vuln.getId();
		this.published = vuln.getPublished();
		this.access = vuln.getAccess();
		this.cvss = vuln.getCvss();
		this.cvss_time = vuln.getCvss_time();
		this.cwe = vuln.getCwe();
		this.impact = vuln.getImpact();
		this.references = vuln.getReferences();
		this.summary = vuln.getSummary();
		this.vulnerable_configuration = vuln.getVulnerable_configuration();
		initSolution(vuln);
	}

	public String getId() {
		return id;
	}

	public void setId(String id) {
		this.id = id;
	}

	public Date getPublished() {
		return published;
	}

	public void setPublished(Date published) {
		this.published = published;
	}

	public Access getAccess() {
		return access;
	}

	public void setAccess(Access access) {
		this.access = access;
	}

	public double getCvss() {
		return cvss;
	}

	public void setCvss(double cvss) {
		this.cvss = cvss;
	}

	public Date getCvss_time() {
		return cvss_time;
	}

	public void setCvss_time(Date cvss_time) {
		this.cvss_time = cvss_time;
	}

	public String getCwe() {
		return cwe;
	}

	public void setCwe(String cwe) {
		this.cwe = cwe;
	}

	public Impact getImpact() {
		return impact;
	}

	public void setImpact(Impact impact) {
		this.impact = impact;
	}

	public String[] getReferences() {
		return references;
	}

	public void setReferences(String[] references) {
		this.references = references;
	}

	public String getSummary() {
		return summary;
	}

	public void setSummary(String summary) {
		this.summary = summary;
	}

	public String[] getVulnerable_configuration() {
		return vulnerable_configuration;
	}

	public void setVulnerable_configuration(String[] vulnerable_configuration) {
		this.vulnerable_configuration = vulnerable_configuration;
	}

	public String getSolution() {
		return solution;
	}

	public void setSolution(String solution) {
		this.solution = solution;
	}
	
	private void initSolution(VulnerabilityDTO vuln) {
		if (vuln.getCwe() != null && !vuln.getCwe().equals("Unknown")) {
			this.solution = "https://cwe.mitre.org/data/definitions/"+vuln.getCwe().split("-")[1];
		}
	}

}
